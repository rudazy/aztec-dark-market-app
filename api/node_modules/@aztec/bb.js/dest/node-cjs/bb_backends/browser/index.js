"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createAsyncBackend = createAsyncBackend;
exports.createSyncBackend = createSyncBackend;
const wasm_js_1 = require("../wasm.js");
const index_js_1 = require("../../barretenberg/index.js");
const index_js_2 = require("../index.js");
/**
 * Create backend of specific type (no fallback)
 */
async function createAsyncBackend(type, options, logger) {
    switch (type) {
        case index_js_2.BackendType.Wasm:
        case index_js_2.BackendType.WasmWorker: {
            const useWorker = type === index_js_2.BackendType.WasmWorker;
            logger(`Using WASM backend (worker: ${useWorker})`);
            const wasm = await wasm_js_1.BarretenbergWasmAsyncBackend.new({
                threads: options.threads,
                wasmPath: options.wasmPath,
                logger,
                memory: options.memory,
                useWorker,
            });
            return new index_js_1.Barretenberg(wasm, options);
        }
        default:
            throw new Error(`Unknown backend type: ${type}`);
    }
}
/**
 * Create backend of specific type (no fallback)
 */
async function createSyncBackend(type, options, logger) {
    switch (type) {
        case index_js_2.BackendType.Wasm:
            logger('Using WASM backend');
            const wasm = await wasm_js_1.BarretenbergWasmSyncBackend.new(options.wasmPath, logger);
            return new index_js_1.BarretenbergSync(wasm);
        default:
            throw new Error(`Backend ${type} not supported for BarretenbergSync`);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYmJfYmFja2VuZHMvYnJvd3Nlci9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQU9BLGdEQXVCQztBQUtELDhDQWNDO0FBakRELHdDQUF1RjtBQUN2RiwwREFBNkU7QUFDN0UsMENBQTBEO0FBRTFEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLGtCQUFrQixDQUN0QyxJQUFpQixFQUNqQixPQUF1QixFQUN2QixNQUE2QjtJQUU3QixRQUFRLElBQUksRUFBRSxDQUFDO1FBQ2IsS0FBSyxzQkFBVyxDQUFDLElBQUksQ0FBQztRQUN0QixLQUFLLHNCQUFXLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztZQUM1QixNQUFNLFNBQVMsR0FBRyxJQUFJLEtBQUssc0JBQVcsQ0FBQyxVQUFVLENBQUM7WUFDbEQsTUFBTSxDQUFDLCtCQUErQixTQUFTLEdBQUcsQ0FBQyxDQUFDO1lBQ3BELE1BQU0sSUFBSSxHQUFHLE1BQU0sc0NBQTRCLENBQUMsR0FBRyxDQUFDO2dCQUNsRCxPQUFPLEVBQUUsT0FBTyxDQUFDLE9BQU87Z0JBQ3hCLFFBQVEsRUFBRSxPQUFPLENBQUMsUUFBUTtnQkFDMUIsTUFBTTtnQkFDTixNQUFNLEVBQUUsT0FBTyxDQUFDLE1BQU07Z0JBQ3RCLFNBQVM7YUFDVixDQUFDLENBQUM7WUFDSCxPQUFPLElBQUksdUJBQVksQ0FBQyxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUM7UUFDekMsQ0FBQztRQUVEO1lBQ0UsTUFBTSxJQUFJLEtBQUssQ0FBQyx5QkFBeUIsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUNyRCxDQUFDO0FBQ0gsQ0FBQztBQUVEOztHQUVHO0FBQ0ksS0FBSyxVQUFVLGlCQUFpQixDQUNyQyxJQUFpQixFQUNqQixPQUF1QixFQUN2QixNQUE2QjtJQUU3QixRQUFRLElBQUksRUFBRSxDQUFDO1FBQ2IsS0FBSyxzQkFBVyxDQUFDLElBQUk7WUFDbkIsTUFBTSxDQUFDLG9CQUFvQixDQUFDLENBQUM7WUFDN0IsTUFBTSxJQUFJLEdBQUcsTUFBTSxxQ0FBMkIsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxNQUFNLENBQUMsQ0FBQztZQUM3RSxPQUFPLElBQUksMkJBQWdCLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFcEM7WUFDRSxNQUFNLElBQUksS0FBSyxDQUFDLFdBQVcsSUFBSSxxQ0FBcUMsQ0FBQyxDQUFDO0lBQzFFLENBQUM7QUFDSCxDQUFDIn0=